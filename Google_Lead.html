<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Lead Performance Â· Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet"/>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOUNDATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}

:root{
  /* Core palette */
  --bg0:   #03030a;
  --bg1:   #07071a;
  --bg2:   #0b0b22;
  --bg3:   #101028;

  /* Glass surfaces */
  --g1: rgba(255,255,255,.032);
  --g2: rgba(255,255,255,.06);
  --g3: rgba(255,255,255,.09);

  /* Borders */
  --b1: rgba(255,255,255,.06);
  --b2: rgba(255,255,255,.11);
  --b3: rgba(255,255,255,.18);

  /* Accent */
  --violet: #7c5cfc;
  --violet2:#a88bff;
  --violet3:#c4b0ff;
  --cyan:   #00e5ff;
  --cyan2:  #80f0ff;
  --emerald:#00f5a0;
  --rose:   #ff4f7b;
  --amber:  #ffb340;
  --sky:    #38c8ff;

  /* Text */
  --t1: #f0eeff;
  --t2: #a89fc8;
  --t3: #5e5880;
  --t4: #3a364f;

  /* Shadows */
  --s1: 0 1px 2px rgba(0,0,0,.8);
  --s2: 0 4px 24px rgba(0,0,0,.6);
  --s3: 0 8px 48px rgba(0,0,0,.7);

  /* Glow */
  --gv: rgba(124,92,252,.28);
  --gc: rgba(0,229,255,.2);
  --ge: rgba(0,245,160,.18);

  /* Layout */
  --pad: 24px;
  --r1: 12px;
  --r2: 18px;
  --r3: 24px;

  /* Transitions */
  --ease: cubic-bezier(.16,1,.3,1);
  --fast: .18s var(--ease);
  --med:  .32s var(--ease);
  --slow: .6s  var(--ease);
}

html{scroll-behavior:smooth;}
body{
  font-family:'Sora',sans-serif;
  background:var(--bg0);
  color:var(--t1);
  min-height:100vh;
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
}

/* â”€â”€ Background atmosphere â”€â”€ */
.bg-canvas{
  position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;
}
.bg-canvas::before{
  content:'';position:absolute;inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 10% -10%, rgba(124,92,252,.13) 0%, transparent 60%),
    radial-gradient(ellipse 60% 50% at 90% 110%, rgba(0,229,255,.07) 0%, transparent 55%),
    radial-gradient(ellipse 40% 40% at 50% 50%,  rgba(124,92,252,.04) 0%, transparent 70%);
}
.bg-canvas::after{
  content:'';position:absolute;inset:0;
  background-image:
    linear-gradient(rgba(124,92,252,.022) 1px,transparent 1px),
    linear-gradient(90deg,rgba(124,92,252,.022) 1px,transparent 1px);
  background-size:48px 48px;
  mask-image:radial-gradient(ellipse 90% 90% at 50% 50%,black 40%,transparent 100%);
}
.orb{position:fixed;border-radius:50%;filter:blur(80px);pointer-events:none;z-index:0;}
.orb-a{width:700px;height:700px;background:radial-gradient(circle,rgba(124,92,252,.1),transparent 70%);top:-200px;left:-200px;animation:drift 22s ease-in-out infinite;}
.orb-b{width:500px;height:500px;background:radial-gradient(circle,rgba(0,229,255,.07),transparent 70%);bottom:-150px;right:-100px;animation:drift 18s ease-in-out infinite reverse;}
.orb-c{width:300px;height:300px;background:radial-gradient(circle,rgba(0,245,160,.05),transparent 70%);top:40%;left:55%;animation:drift 26s ease-in-out infinite 4s;}
@keyframes drift{
  0%,100%{transform:translate(0,0)scale(1)}
  30%{transform:translate(50px,-40px)scale(1.04)}
  70%{transform:translate(-30px,30px)scale(.97)}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#loader{
  position:fixed;inset:0;z-index:9999;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:28px;
  background:var(--bg0);
  transition:opacity .5s ease,visibility .5s ease;
}
#loader.out{opacity:0;visibility:hidden;}

.loader-logo{
  width:60px;height:60px;border-radius:18px;
  background:linear-gradient(145deg,#e8602a,#c93d1b);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 40px rgba(232,96,42,.4);
  animation:logoPulse 2s ease-in-out infinite;
}
@keyframes logoPulse{0%,100%{box-shadow:0 0 40px rgba(232,96,42,.4)}50%{box-shadow:0 0 60px rgba(232,96,42,.7)}}

.loader-rings{position:relative;width:56px;height:56px;}
.loader-rings::before,.loader-rings::after{
  content:'';position:absolute;border-radius:50%;border:1.5px solid transparent;
}
.loader-rings::before{
  inset:0;border-top-color:var(--violet);
  animation:spin .9s linear infinite;
}
.loader-rings::after{
  inset:8px;border-bottom-color:var(--cyan);
  animation:spin .65s linear infinite reverse;
}
@keyframes spin{to{transform:rotate(360deg)}}
.loader-dot{
  position:absolute;top:50%;left:50%;
  width:8px;height:8px;border-radius:50%;
  background:var(--violet2);
  transform:translate(-50%,-50%);
  box-shadow:0 0 12px var(--violet);
}
.loader-text{
  font-family:'Fira Code',monospace;
  font-size:11px;letter-spacing:4px;
  color:var(--t3);text-transform:uppercase;
}
.loader-bar-wrap{width:200px;height:2px;background:var(--g2);border-radius:1px;overflow:hidden;}
.loader-bar{height:100%;background:linear-gradient(90deg,var(--violet),var(--cyan));border-radius:1px;width:0%;transition:width .4s ease;}

#errmsg{
  display:none;max-width:480px;padding:28px 32px;
  background:rgba(255,79,123,.05);
  border:1px solid rgba(255,79,123,.2);
  border-radius:var(--r2);
  color:#ffb0c4;font-size:13px;line-height:1.9;text-align:center;
}
#errmsg strong{color:var(--rose);}
#errmsg code{
  display:block;margin-top:14px;padding:12px 16px;
  background:rgba(0,0,0,.5);border-radius:10px;
  font-family:'Fira Code',monospace;font-size:11px;
  color:var(--violet2);text-align:left;line-height:1.9;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.shell{position:relative;z-index:1;display:flex;flex-direction:column;min-height:100vh;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOPBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.topbar{
  position:sticky;top:0;z-index:200;
  background:rgba(3,3,10,.85);
  backdrop-filter:blur(28px) saturate(160%);
  border-bottom:1px solid var(--b1);
  padding:0 var(--pad);
  height:64px;
  display:flex;align-items:center;gap:16px;
  flex-shrink:0;
}
.topbar::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent 0%,var(--violet) 30%,var(--cyan) 70%,transparent 100%);
  opacity:.25;
}

/* Brand */
.brand{display:flex;align-items:center;gap:13px;flex-shrink:0;}
.brand-mark{
  width:42px;height:42px;border-radius:13px;
  background:linear-gradient(145deg,#e8602a 0%,#c93d1b 55%,#a82e10 100%);
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 4px 20px rgba(220,70,30,.45),inset 0 1px 0 rgba(255,200,80,.25);
  position:relative;
}
.brand-mark::before{
  content:'';position:absolute;inset:0;border-radius:13px;
  background:linear-gradient(150deg,rgba(255,210,100,.22) 0%,transparent 55%);
  pointer-events:none;
}
.brand-name{font-size:17px;font-weight:800;color:var(--t1);letter-spacing:-.4px;line-height:1.1;}
.brand-sub{font-family:'Fira Code',monospace;font-size:9px;letter-spacing:2.5px;color:var(--t3);text-transform:uppercase;margin-top:2px;}

/* Live badge */
.live-badge{
  display:flex;align-items:center;gap:7px;
  padding:5px 13px 5px 9px;
  background:rgba(0,245,160,.07);
  border:1px solid rgba(0,245,160,.16);
  border-radius:100px;
  font-family:'Fira Code',monospace;
  font-size:10px;letter-spacing:2px;color:var(--emerald);
  flex-shrink:0;
}
.live-dot{
  width:6px;height:6px;border-radius:50%;
  background:var(--emerald);
  box-shadow:0 0 8px var(--emerald);
  animation:pulse 2s ease-in-out infinite;
}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.2;transform:scale(.5)}}

.topbar-mid{flex:1;display:flex;align-items:center;justify-content:center;}

/* Tabs */
.tabs{
  display:flex;align-items:center;gap:2px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--b1);
  border-radius:12px;padding:3px;
}
.tab{
  padding:7px 18px;border:none;border-radius:9px;
  background:transparent;color:var(--t3);
  cursor:pointer;font-family:'Sora',sans-serif;
  font-size:12.5px;font-weight:600;
  transition:all var(--fast);white-space:nowrap;
  position:relative;overflow:hidden;
}
.tab::before{
  content:'';position:absolute;inset:0;border-radius:9px;
  background:linear-gradient(135deg,var(--violet),#6040e0);
  opacity:0;transition:opacity var(--fast);
}
.tab span{position:relative;z-index:1;}
.tab.on{color:#fff;}
.tab.on::before{opacity:1;}
.tab.on{box-shadow:0 2px 16px rgba(124,92,252,.45);}
.tab:hover:not(.on){color:var(--t2);background:var(--g1);}

/* Right controls */
.topbar-right{display:flex;align-items:center;gap:10px;flex-shrink:0;margin-left:auto;}
#sname{
  font-family:'Fira Code',monospace;font-size:10px;
  color:var(--violet2);
  background:rgba(124,92,252,.09);
  border:1px solid rgba(124,92,252,.2);
  border-radius:100px;padding:4px 12px;
  max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
}
#rts{font-family:'Fira Code',monospace;font-size:10px;color:var(--t3);}
.btn-refresh{
  display:flex;align-items:center;gap:7px;
  padding:7px 14px;border-radius:10px;
  background:var(--g1);border:1px solid var(--b2);
  color:var(--t2);cursor:pointer;
  font-family:'Sora',sans-serif;font-size:12px;font-weight:600;
  transition:all var(--fast);
}
.btn-refresh:hover{background:var(--g2);color:var(--t1);border-color:var(--b3);box-shadow:0 0 20px rgba(124,92,252,.15);}
.btn-refresh svg{transition:transform .5s ease;}
.btn-refresh:hover svg{transform:rotate(180deg);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FILTER BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.filterbar{
  background:rgba(7,7,26,.7);
  backdrop-filter:blur(12px);
  border-bottom:1px solid var(--b1);
  padding:10px var(--pad);
  display:flex;align-items:center;gap:10px;flex-wrap:wrap;
  position:relative;z-index:1;flex-shrink:0;
}
.filter-label{
  font-family:'Fira Code',monospace;
  font-size:9px;letter-spacing:3px;color:var(--t3);
  text-transform:uppercase;margin-right:4px;flex-shrink:0;
}
.fwrap{display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
.fg{display:flex;flex-direction:column;gap:3px;}
.fg-lbl{font-size:9.5px;font-weight:600;letter-spacing:.3px;color:var(--t3);text-transform:uppercase;}
.fsel{
  background:var(--g1);border:1px solid var(--b1);
  border-radius:8px;color:var(--t2);
  padding:7px 30px 7px 11px;
  font-size:12px;font-family:'Sora',sans-serif;font-weight:500;
  outline:none;cursor:pointer;
  appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%235e5880'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 10px center;
  transition:all var(--fast);min-width:130px;
}
.fsel:focus{border-color:rgba(124,92,252,.5);box-shadow:0 0 0 3px rgba(124,92,252,.1);color:var(--t1);}
.fsel:disabled{opacity:.2;cursor:not-allowed;}
option{background:#0b0b22;}

.filter-sep{width:1px;height:28px;background:var(--b1);flex-shrink:0;margin:0 4px;}

.btn-reset{
  margin-left:auto;
  padding:7px 14px;border-radius:8px;
  background:transparent;border:1px solid var(--b1);
  color:var(--t3);cursor:pointer;
  font-family:'Fira Code',monospace;font-size:10px;letter-spacing:1.5px;
  text-transform:uppercase;transition:all var(--fast);
}
.btn-reset:hover{border-color:var(--rose);color:var(--rose);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KPI ROW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.kpi-row{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:14px;padding:20px var(--pad) 0;
  position:relative;z-index:1;
}
.kpi{
  position:relative;overflow:hidden;
  background:var(--g1);
  border:1px solid var(--b1);
  border-radius:var(--r2);padding:22px 22px 18px;
  transition:all var(--med);cursor:default;
}
.kpi::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.04) 0%,transparent 60%);
  pointer-events:none;
}
.kpi:hover{
  transform:translateY(-5px);
  border-color:var(--b3);
  box-shadow:var(--s3);
}
.kpi-accent{position:absolute;top:0;left:0;right:0;height:2px;}
.kpi-glow{position:absolute;top:-60px;left:-60px;width:160px;height:160px;border-radius:50%;opacity:.07;filter:blur(36px);pointer-events:none;}
.kpi-icon{
  width:38px;height:38px;border-radius:11px;
  display:flex;align-items:center;justify-content:center;
  font-size:18px;margin-bottom:14px;position:relative;
}

.k-violet .kpi-accent{background:linear-gradient(90deg,var(--violet),transparent);}
.k-violet .kpi-glow{background:var(--violet);}
.k-violet .kpi-icon{background:rgba(124,92,252,.15);border:1px solid rgba(124,92,252,.2);}
.k-violet .kpi-label{color:var(--violet2);}

.k-emerald .kpi-accent{background:linear-gradient(90deg,var(--emerald),transparent);}
.k-emerald .kpi-glow{background:var(--emerald);}
.k-emerald .kpi-icon{background:rgba(0,245,160,.1);border:1px solid rgba(0,245,160,.18);}
.k-emerald .kpi-label{color:var(--emerald);}

.k-rose .kpi-accent{background:linear-gradient(90deg,var(--rose),transparent);}
.k-rose .kpi-glow{background:var(--rose);}
.k-rose .kpi-icon{background:rgba(255,79,123,.1);border:1px solid rgba(255,79,123,.18);}
.k-rose .kpi-label{color:var(--rose);}

.k-amber .kpi-accent{background:linear-gradient(90deg,var(--amber),transparent);}
.k-amber .kpi-glow{background:var(--amber);}
.k-amber .kpi-icon{background:rgba(255,179,64,.1);border:1px solid rgba(255,179,64,.18);}
.k-amber .kpi-label{color:var(--amber);}

.kpi-label{font-size:10.5px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px;}
.kpi-val{font-size:48px;font-weight:800;color:#fff;line-height:1;letter-spacing:-3px;transition:all var(--med);}
.kpi-sub{font-size:11.5px;color:var(--t3);margin-top:8px;font-weight:400;}

/* KPI entrance */
.kpi{animation:kpiIn .6s var(--ease) both;}
.kpi:nth-child(1){animation-delay:.08s}
.kpi:nth-child(2){animation-delay:.14s}
.kpi:nth-child(3){animation-delay:.20s}
.kpi:nth-child(4){animation-delay:.26s}
@keyframes kpiIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTENT AREA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.content{padding:18px var(--pad) 48px;position:relative;z-index:1;flex:1;}
.hidden{display:none!important;}

/* Grid layouts */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;}
.g5{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;}
.full{grid-column:1/-1;}

/* Card */
.card{
  background:var(--g1);
  border:1px solid var(--b1);
  border-radius:var(--r2);
  padding:22px 24px;
  position:relative;overflow:hidden;
  transition:border-color var(--fast),box-shadow var(--fast);
}
.card::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.025) 0%,transparent 55%);
  pointer-events:none;border-radius:var(--r2);
}
.card:hover{border-color:var(--b2);box-shadow:var(--s2);}

.card-head{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:22px;
}
.card-title{font-size:14px;font-weight:700;color:var(--t1);letter-spacing:-.2px;}
.card-badge{
  font-family:'Fira Code',monospace;
  font-size:10px;letter-spacing:1px;
  color:var(--t3);background:var(--g2);
  border:1px solid var(--b1);border-radius:100px;
  padding:3px 10px;white-space:nowrap;
}
.card-badge.hi{color:var(--violet2);border-color:rgba(124,92,252,.2);background:rgba(124,92,252,.08);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MANAGER BARS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mgr-row{margin-bottom:20px;}
.mgr-row:last-child{margin-bottom:0;}
.mgr-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:9px;}
.mgr-name{display:flex;align-items:center;gap:10px;font-size:13.5px;font-weight:700;color:var(--t1);}
.color-dot{width:9px;height:9px;border-radius:50%;flex-shrink:0;box-shadow:0 0 8px currentColor;}
.mgr-badges{display:flex;gap:6px;}
.pill{
  font-family:'Fira Code',monospace;font-size:10px;
  border-radius:100px;padding:3px 10px;letter-spacing:.5px;
}
.pill-rcv{background:rgba(255,255,255,.05);color:var(--t2);border:1px solid var(--b1);}
.pill-cv{background:rgba(0,245,160,.08);color:var(--emerald);border:1px solid rgba(0,245,160,.15);}

.bar-wrap{background:rgba(255,255,255,.04);border-radius:6px;height:8px;overflow:hidden;position:relative;}
.bar-fill{height:100%;border-radius:6px;position:relative;transition:width 1s var(--ease);}
.bar-fill::after{
  content:'';position:absolute;right:0;top:0;bottom:0;width:12px;
  background:rgba(255,255,255,.35);filter:blur(4px);border-radius:6px;
}
.bar-sub{height:3px;background:rgba(255,255,255,.03);border-radius:2px;margin-top:4px;overflow:hidden;}
.bar-sub-fill{height:100%;background:var(--emerald);opacity:.65;border-radius:2px;transition:width 1s var(--ease) .1s;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WEEKLY TREND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.trend-row{margin-bottom:14px;}
.trend-row:last-child{margin-bottom:0;}
.trend-meta{display:flex;justify-content:space-between;margin-bottom:6px;}
.trend-lbl{font-family:'Fira Code',monospace;font-size:10.5px;color:var(--t3);letter-spacing:.5px;}
.trend-nums{font-size:12px;font-weight:500;color:var(--t2);}
.trend-nums em{color:var(--emerald);font-style:normal;font-weight:700;}
.trend-track{height:10px;background:rgba(255,255,255,.04);border-radius:5px;overflow:hidden;position:relative;}
.trend-rcv{position:absolute;top:0;left:0;height:100%;border-radius:5px;transition:width 1s var(--ease);}
.trend-ach{position:absolute;bottom:2px;left:0;height:4px;background:var(--emerald);opacity:.8;border-radius:2px;transition:width 1s var(--ease) .15s;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOP COUNSELLORS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.top-card{
  border-radius:var(--r1);padding:18px 16px;
  position:relative;overflow:hidden;
  transition:transform var(--med),box-shadow var(--med);
  cursor:default;
}
.top-card::before{
  content:'';position:absolute;inset:0;border-radius:var(--r1);
  background:linear-gradient(145deg,rgba(255,255,255,.07) 0%,transparent 60%);
  pointer-events:none;
}
.top-card:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(0,0,0,.4);}
.top-rank{
  font-family:'Fira Code',monospace;font-size:11px;
  color:var(--t4);margin-bottom:6px;letter-spacing:1px;
  display:flex;align-items:center;gap:6px;
}
.rank-medal{font-size:16px;}
.top-name{font-size:14px;font-weight:800;color:#fff;margin-bottom:3px;line-height:1.25;}
.top-mgr{font-size:11px;color:var(--t3);margin-bottom:14px;}
.top-num{font-size:38px;font-weight:800;line-height:1;letter-spacing:-1.5px;}
.top-cv{font-family:'Fira Code',monospace;font-size:10.5px;color:var(--emerald);margin-top:6px;letter-spacing:.5px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.table-wrap{
  border:1px solid var(--b1);border-radius:var(--r2);
  overflow-x:auto;overflow-y:visible;
}
.table-wrap::-webkit-scrollbar{height:4px;}
.table-wrap::-webkit-scrollbar-thumb{background:rgba(124,92,252,.3);border-radius:2px;}
table{width:100%;border-collapse:collapse;}
thead tr{background:rgba(124,92,252,.06);}
th{
  padding:14px 18px;text-align:left;
  font-size:10.5px;font-weight:700;letter-spacing:.5px;
  color:var(--t3);text-transform:uppercase;white-space:nowrap;
  border-bottom:1px solid var(--b1);
}
td{
  padding:13px 18px;
  border-top:1px solid rgba(255,255,255,.035);
  font-size:13px;color:var(--t2);
  transition:background var(--fast);
}
tr:hover td{background:rgba(124,92,252,.04);}
.td-name{font-weight:700;color:var(--t1);font-size:13.5px;}
.td-num{font-size:20px;font-weight:800;font-family:'Sora',sans-serif;}
.td-rank{font-family:'Fira Code',monospace;font-size:11px;color:var(--t4);font-weight:500;}

.tag{
  display:inline-block;border-radius:100px;
  padding:3px 11px;font-size:11px;font-weight:600;
}
.cv-bar-wrap{display:flex;align-items:center;gap:9px;}
.cv-track{width:65px;background:rgba(255,255,255,.05);border-radius:3px;height:4px;}
.cv-fill{height:100%;border-radius:3px;transition:width .8s var(--ease);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROCESS CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.proc-card{
  background:var(--g1);border:1px solid var(--b1);
  border-radius:var(--r2);padding:22px;
  position:relative;overflow:hidden;
  transition:all var(--med);
}
.proc-card::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.03) 0%,transparent 55%);
  pointer-events:none;
}
.proc-card:hover{transform:translateY(-5px);box-shadow:var(--s3);border-color:var(--b2);}
.proc-name{font-size:15px;font-weight:800;color:var(--t1);margin-bottom:16px;margin-top:6px;}
.proc-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;}
.proc-metric{}
.proc-mlbl{font-size:9.5px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:4px;}
.proc-mval{font-size:28px;font-weight:900;line-height:1;letter-spacing:-1px;}
.proc-track{height:4px;background:rgba(255,255,255,.05);border-radius:2px;overflow:hidden;}
.proc-fill{height:100%;border-radius:2px;transition:width .9s var(--ease);}
.proc-badge{
  position:absolute;top:16px;right:16px;z-index:1;
  font-family:'Fira Code',monospace;font-size:11px;font-weight:600;
  border-radius:100px;padding:4px 11px;letter-spacing:.5px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CALENDAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cal-layout{display:grid;grid-template-columns:1fr 300px;gap:16px;}
.cal-nav{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;}
.cal-btn{
  background:var(--g1);border:1px solid var(--b2);
  border-radius:10px;color:var(--t2);cursor:pointer;
  width:38px;height:38px;display:flex;align-items:center;justify-content:center;
  font-size:18px;transition:all var(--fast);
}
.cal-btn:hover{background:var(--g2);color:var(--t1);box-shadow:0 0 16px var(--gv);border-color:rgba(124,92,252,.4);}
.cal-month{font-size:22px;font-weight:800;color:#fff;letter-spacing:-.5px;}
.cal-year{font-family:'Fira Code',monospace;font-size:11px;color:var(--t3);letter-spacing:2px;margin-top:2px;text-align:center;}

.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;}
.cal-dow{text-align:center;font-family:'Fira Code',monospace;font-size:9px;color:var(--t4);padding:6px 0;letter-spacing:1.5px;}
.cal-day{
  aspect-ratio:1;display:flex;align-items:center;justify-content:center;
  border-radius:10px;cursor:pointer;font-size:13px;font-weight:500;
  border:1px solid transparent;position:relative;
  transition:all .16s ease;color:var(--t2);
}
.cal-day:hover{background:var(--g2);color:var(--t1);transform:scale(1.1);}
.cal-day.has{background:rgba(124,92,252,.1);color:var(--violet2);border-color:rgba(124,92,252,.25);}
.cal-day.sel{
  background:linear-gradient(135deg,var(--violet),#6040e0);
  color:#fff;font-weight:700;border-color:transparent;
  box-shadow:0 2px 16px rgba(124,92,252,.5);
}
.cal-day.sel::after{content:none;}
.cal-pip{position:absolute;bottom:3px;width:4px;height:4px;border-radius:50%;background:var(--violet2);}

.cal-legend{display:flex;gap:18px;justify-content:center;margin-top:16px;}
.cal-leg{display:flex;align-items:center;gap:7px;font-family:'Fira Code',monospace;font-size:10px;color:var(--t3);letter-spacing:.5px;}
.cal-leg-dot{width:11px;height:11px;border-radius:4px;}

.cal-side{display:flex;flex-direction:column;gap:14px;}
.wk-item{
  padding:11px 14px;border-radius:10px;
  background:rgba(124,92,252,.06);
  border-left:3px solid var(--violet);
  margin-bottom:7px;
  transition:background var(--fast);
}
.wk-item:hover{background:rgba(124,92,252,.12);}
.wk-name{font-size:13px;font-weight:700;color:var(--violet2);}
.wk-dates{font-family:'Fira Code',monospace;font-size:10px;color:var(--t3);margin-top:3px;letter-spacing:.3px;}
.sel-scroll{max-height:160px;overflow-y:auto;}
.sel-scroll::-webkit-scrollbar{width:3px;}
.sel-scroll::-webkit-scrollbar-thumb{background:rgba(124,92,252,.3);border-radius:2px;}
.sel-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--b1);font-size:12.5px;}
.sel-remove{background:none;border:none;color:var(--rose);cursor:pointer;font-size:17px;line-height:1;transition:opacity var(--fast);}
.sel-remove:hover{opacity:.6;}
.btn-clear{
  margin-top:10px;width:100%;padding:9px;
  background:rgba(255,79,123,.06);
  border:1px solid rgba(255,79,123,.2);
  border-radius:9px;color:var(--rose);cursor:pointer;
  font-family:'Fira Code',monospace;font-size:10px;letter-spacing:2px;
  text-transform:uppercase;transition:all var(--fast);
}
.btn-clear:hover{background:rgba(255,79,123,.14);}

.no-data{
  color:var(--t4);text-align:center;padding:52px 20px;
  font-family:'Fira Code',monospace;font-size:11px;letter-spacing:2px;text-transform:uppercase;
}

/* Scrollbars */
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:rgba(255,255,255,.02);}
::-webkit-scrollbar-thumb{background:rgba(124,92,252,.22);border-radius:3px;}
::-webkit-scrollbar-thumb:hover{background:rgba(124,92,252,.4);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:1200px){
  .kpi-row{grid-template-columns:1fr 1fr;}
  .g5{grid-template-columns:repeat(3,1fr);}
}
@media(max-width:960px){
  .topbar{height:auto;padding:12px var(--pad);flex-wrap:wrap;gap:10px;}
  .topbar-mid{order:3;flex:0 0 100%;}
  .topbar-right{order:2;}
  .tabs{overflow-x:auto;justify-content:flex-start;}
  .g2,.g3,.cal-layout{grid-template-columns:1fr;}
  .full{grid-column:1;}
  .filterbar{gap:8px;}
  .fsel{min-width:110px;}
}
@media(max-width:600px){
  :root{--pad:14px;}
  .kpi-row{grid-template-columns:1fr 1fr;}
  .g5{grid-template-columns:1fr 1fr;}
  .g3{grid-template-columns:1fr;}
  .kpi-val{font-size:36px;}
  .tabs{flex-wrap:wrap;}
}
</style>
</head>
<body>

<!-- Background -->
<div class="bg-canvas"></div>
<div class="orb orb-a"></div>
<div class="orb orb-b"></div>
<div class="orb orb-c"></div>

<!-- â•â• LOADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="loader">
  <div class="loader-logo">
    <svg width="28" height="24" viewBox="0 0 28 24" fill="none">
      <path d="M14 2L1 9l13 7 13-7-13-7z" fill="#fff" opacity=".95"/>
      <path d="M14 2L1 9l13 7 13-7-13-7z" fill="url(#ls)" opacity=".4"/>
      <line x1="25" y1="9" x2="25" y2="17" stroke="#f5c842" stroke-width="2" stroke-linecap="round"/>
      <circle cx="25" cy="18.5" r="2" fill="#f5c842"/>
      <line x1="23.5" y1="19.5" x2="22.8" y2="22.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
      <line x1="25" y1="20.2" x2="25" y2="23.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
      <line x1="26.5" y1="19.5" x2="27.2" y2="22.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
      <path d="M8 13v5.5c0 1.3 2.7 2.5 6 2.5s6-1.2 6-2.5V13" stroke="#fff" stroke-width="1.8" stroke-linecap="round" fill="none" opacity=".6"/>
      <defs><linearGradient id="ls" x1="1" y1="2" x2="27" y2="16" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="transparent"/></linearGradient></defs>
    </svg>
  </div>
  <div class="loader-rings"><div class="loader-dot"></div></div>
  <div class="loader-text" id="lmsg">Connecting to Sheet...</div>
  <div class="loader-bar-wrap"><div class="loader-bar" id="lbar"></div></div>
  <div id="errmsg"></div>
</div>

<!-- â•â• SHELL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="shell" id="shell" style="display:none">

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="brand">
      <div class="brand-mark">
        <svg width="24" height="20" viewBox="0 0 28 24" fill="none">
          <path d="M14 2L1 9l13 7 13-7-13-7z" fill="#fff" opacity=".95"/>
          <line x1="25" y1="9" x2="25" y2="17" stroke="#f5c842" stroke-width="2" stroke-linecap="round"/>
          <circle cx="25" cy="18.5" r="2" fill="#f5c842"/>
          <line x1="23.5" y1="19.5" x2="22.8" y2="22.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
          <line x1="25" y1="20.2" x2="25" y2="23.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
          <line x1="26.5" y1="19.5" x2="27.2" y2="22.5" stroke="#f5c842" stroke-width="1.3" stroke-linecap="round"/>
          <path d="M8 13v5.5c0 1.3 2.7 2.5 6 2.5s6-1.2 6-2.5V13" stroke="#fff" stroke-width="1.8" stroke-linecap="round" fill="none" opacity=".6"/>
        </svg>
      </div>
      <div>
        <div class="brand-name">Lead Performance</div>
        <div class="brand-sub">Live Analytics</div>
      </div>
    </div>

    <div class="topbar-mid">
      <div class="tabs">
        <button class="tab on"  onclick="go('overview')"><span>Overview</span></button>
        <button class="tab"     onclick="go('managers')"><span>Managers</span></button>
        <button class="tab"     onclick="go('counsellors')"><span>Counsellors</span></button>
        <button class="tab"     onclick="go('process')"><span>Process</span></button>
        <button class="tab"     onclick="go('calendar')"><span>Calendar</span></button>
      </div>
    </div>

    <div class="topbar-right">
      <div class="live-badge"><span class="live-dot"></span>LIVE</div>
      <span id="sname" style="display:none"></span>
      <span id="rts"></span>
      <button class="btn-refresh" onclick="loadData()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M21 2v6h-6M3 12a9 9 0 0115-6.7L21 8M3 22v-6h6M21 12a9 9 0 01-15 6.7L3 16"/></svg>
        Refresh
      </button>
    </div>
  </header>

  <!-- FILTER BAR -->
  <div class="filterbar">
    <span class="filter-label">Filter</span>
    <div class="fwrap">
      <div class="fg">
        <span class="fg-lbl">Month</span>
        <select class="fsel" id="fm" onchange="onMonth()"><option value="">All Months</option></select>
      </div>
      <div class="fg">
        <span class="fg-lbl">Week</span>
        <select class="fsel" id="fw" onchange="render()" disabled><option value="">All Weeks</option></select>
      </div>
      <div class="filter-sep"></div>
      <div class="fg">
        <span class="fg-lbl">Manager</span>
        <select class="fsel" id="fmg" onchange="onMgr()"><option value="">All Managers</option></select>
      </div>
      <div class="fg">
        <span class="fg-lbl">Process</span>
        <select class="fsel" id="fp" onchange="render()"><option value="">All Processes</option></select>
      </div>
      <div class="fg">
        <span class="fg-lbl">Counsellor</span>
        <select class="fsel" id="fc" onchange="render()"><option value="">All Counsellors</option></select>
      </div>
    </div>
    <button class="btn-reset" onclick="resetF()">âœ• Reset</button>
  </div>

  <!-- KPI ROW -->
  <div class="kpi-row">
    <div class="kpi k-violet">
      <div class="kpi-accent"></div><div class="kpi-glow"></div>
      <div class="kpi-icon">ğŸ“¥</div>
      <div class="kpi-label">Leads Received</div>
      <div class="kpi-val" id="kv1">â€”</div>
      <div class="kpi-sub" id="ks1">total records</div>
    </div>
    <div class="kpi k-emerald">
      <div class="kpi-accent"></div><div class="kpi-glow"></div>
      <div class="kpi-icon">ğŸ¯</div>
      <div class="kpi-label">Apps Achieved</div>
      <div class="kpi-val" id="kv2">â€”</div>
      <div class="kpi-sub">converted</div>
    </div>
    <div class="kpi k-rose">
      <div class="kpi-accent"></div><div class="kpi-glow"></div>
      <div class="kpi-icon">ğŸ“ˆ</div>
      <div class="kpi-label">Conversion Rate</div>
      <div class="kpi-val" id="kv3">â€”</div>
      <div class="kpi-sub">received â†’ achieved</div>
    </div>
    <div class="kpi k-amber">
      <div class="kpi-accent"></div><div class="kpi-glow"></div>
      <div class="kpi-icon">ğŸ‘¥</div>
      <div class="kpi-label">Active Managers</div>
      <div class="kpi-val" id="kv4">â€”</div>
      <div class="kpi-sub" id="ks4">teams</div>
    </div>
  </div>

  <!-- â•â• CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="content">

    <!-- OVERVIEW -->
    <div id="tab-overview">
      <div class="g2" style="margin-bottom:16px;">
        <div class="card">
          <div class="card-head">
            <span class="card-title">Manager Performance</span>
            <span class="card-badge hi" id="mgr-badge">â€”</span>
          </div>
          <div id="mgrbars"><div class="no-data">No data</div></div>
        </div>
        <div class="card">
          <div class="card-head">
            <span class="card-title">Weekly Trend</span>
            <span class="card-badge" id="trend-badge">â€”</span>
          </div>
          <div id="trend"><div class="no-data">No data</div></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head">
          <span class="card-title">Top Performing Counsellors</span>
          <span class="card-badge">Rankings</span>
        </div>
        <div class="g5" id="topcards"><div class="no-data">No data</div></div>
      </div>
    </div>

    <!-- MANAGERS -->
    <div id="tab-managers" class="hidden">
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>Manager</th><th>Received</th><th>Achieved</th>
            <th>Conv %</th><th>Progress</th><th>Processes</th>
          </tr></thead>
          <tbody id="mgrtbody"></tbody>
        </table>
      </div>
    </div>

    <!-- COUNSELLORS -->
    <div id="tab-counsellors" class="hidden">
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>#</th><th>Counsellor</th><th>Manager</th>
            <th>Team Leader</th><th>Received</th><th>Achieved</th><th>Conv %</th>
          </tr></thead>
          <tbody id="cnsltbody"></tbody>
        </table>
      </div>
    </div>

    <!-- PROCESS -->
    <div id="tab-process" class="hidden">
      <div class="g3" id="procgrid"></div>
    </div>

    <!-- CALENDAR -->
    <div id="tab-calendar" class="hidden">
      <div class="cal-layout">
        <div class="card">
          <div class="cal-nav">
            <button class="cal-btn" onclick="calNav(-1)">â€¹</button>
            <div style="text-align:center">
              <div class="cal-month" id="calmn"></div>
              <div class="cal-year"  id="calyr"></div>
            </div>
            <button class="cal-btn" onclick="calNav(1)">â€º</button>
          </div>
          <div class="cal-grid" id="cgrid"></div>
          <div class="cal-legend">
            <div class="cal-leg"><div class="cal-leg-dot" style="background:rgba(124,92,252,.12);border:1px solid rgba(124,92,252,.3)"></div>Has data</div>
            <div class="cal-leg"><div class="cal-leg-dot" style="background:linear-gradient(135deg,#7c5cfc,#6040e0)"></div>Selected</div>
          </div>
        </div>
        <div class="cal-side">
          <div class="card">
            <div class="card-head"><span class="card-title">Week Ranges</span></div>
            <div id="wkranges"></div>
          </div>
          <div class="card" style="flex:1">
            <div class="card-head">
              <span class="card-title">Selected</span>
              <span class="card-badge" id="selcnt">0</span>
            </div>
            <div class="sel-scroll" id="sellist"></div>
            <button class="btn-clear" id="btnclr" onclick="clearSel()" style="display:none">Clear All</button>
          </div>
        </div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /shell -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzPf5ldQHkRk83JDPLpRJSDVemIHqhegAtO0aABUZtgIHaQ-kuVbEwvkYfpqQjmogwV/exec";
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var ALL=[], FOPTS={}, CT="overview", SEL=new Set();
var now=new Date(), CM=now.getMonth(), CY=now.getFullYear();
var MN=["January","February","March","April","May","June","July","August","September","October","November","December"];
var DN=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
var MD=[31,28,31,30,31,30,31,31,30,31,30,31];
var MM={
  January:{r:[[1,11],[12,18],[19,25],[26,31]]},
  February:{r:[[1,7],[8,14],[15,21],[22,28]]},
  March:{r:[[1,7],[8,14],[15,21],[22,31]]},
  April:{r:[[1,7],[8,14],[15,21],[22,30]]},
  May:{r:[[1,7],[8,14],[15,21],[22,31]]},
  June:{r:[[1,7],[8,14],[15,21],[22,30]]},
  July:{r:[[1,7],[8,14],[15,21],[22,31]]},
  August:{r:[[1,7],[8,14],[15,21],[22,31]]},
  September:{r:[[1,7],[8,14],[15,21],[22,30]]},
  October:{r:[[1,7],[8,14],[15,21],[22,31]]},
  November:{r:[[1,7],[8,14],[15,21],[22,30]]},
  December:{r:[[1,7],[8,14],[15,21],[22,31]]}
};

// Dynamic color palette â€” vibrant, distinct
var PAL=["#7c5cfc","#00e5ff","#ff4f7b","#ffb340","#00f5a0","#38c8ff","#ff6e40","#c084fc","#34d399","#f59e0b"];
var MC={};

function buildMC(){
  MC={};
  var mgrs=[...new Set(ALL.map(function(d){return d.manager;}).filter(Boolean))].sort();
  mgrs.forEach(function(m,i){MC[m]=PAL[i%PAL.length];});
}

// â”€â”€ Animated counter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function animCount(el,to,suffix){
  suffix=suffix||"";
  var from=0,dur=700,start=null;
  function step(ts){
    if(!start)start=ts;
    var p=Math.min((ts-start)/dur,1);
    var val=Math.round(from+(to-from)*easeOut(p));
    el.textContent=val+suffix;
    if(p<1)requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}
function easeOut(t){return 1-Math.pow(1-t,3);}

// â”€â”€ JSONP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function jsonp(action,cb){
  var fn="_jp_"+action.replace(/\W/g,"")+"_"+Date.now();
  window[fn]=function(d){
    delete window[fn];
    var el=document.getElementById(fn);
    if(el)el.parentNode.removeChild(el);
    cb(null,d);
  };
  var s=document.createElement("script");
  s.id=fn;
  s.src=SCRIPT_URL+"?action="+action+"&callback="+fn+"&t="+Date.now();
  s.onerror=function(){
    delete window[fn];
    var el=document.getElementById(fn);
    if(el)el.parentNode.removeChild(el);
    cb(new Error("Failed: "+action));
  };
  document.head.appendChild(s);
}

// â”€â”€ LOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener("DOMContentLoaded",loadData);

function setBar(pct){
  var b=document.getElementById("lbar");
  if(b)b.style.width=pct+"%";
}
function sm(t){var e=document.getElementById("lmsg");if(e)e.textContent=t;}

function loadData(){
  sm("Connecting to Google Sheet...");
  setBar(10);
  var loader=document.getElementById("loader");
  loader.style.display="flex";loader.classList.remove("out");
  document.getElementById("shell").style.display="none";

  jsonp("getFilterOptions",function(err,o){
    if(err){showErr(err.message);return;}
    if(!o||!o.ok){showErr((o&&o.error)||"getFilterOptions failed");return;}
    FOPTS=o; fillF(o); setBar(45);
    sm("Loading sheet data...");

    jsonp("getLiveData",function(err2,d){
      if(err2){showErr(err2.message);return;}
      if(!d||!d.ok){showErr((d&&d.error)||"getLiveData failed");return;}
      ALL=d.rows||[];
      buildMC();
      setBar(100);
      var sn=document.getElementById("sname");
      var rt=document.getElementById("rts");
      if(d.sheetInfo){
        sn.textContent=d.sheetInfo.name+" Â· "+d.sheetInfo.totalRows+" rows";
        sn.style.display="";
      }
      if(rt) rt.textContent="Updated "+new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
      setTimeout(function(){
        loader.classList.add("out");
        setTimeout(function(){
          loader.style.display="none";
          document.getElementById("shell").style.display="flex";
          go("overview");
        },500);
      },300);
    });
  });
}

function showErr(msg){
  sm("");
  setBar(0);
  var el=document.getElementById("errmsg");
  el.innerHTML="<strong>âš  Connection failed</strong><br><br>"+xe(msg)+"<br><br>Redeploy your Apps Script:<code>Deploy â†’ Manage Deployments â†’ Edit âœ â†’ New Version â†’ Deploy</code>";
  el.style.display="block";
}

// â”€â”€ FILTERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fillF(o){
  function add(id,arr){
    var s=document.getElementById(id);
    (arr||[]).forEach(function(v){
      var op=document.createElement("option");op.value=v;op.textContent=v;s.appendChild(op);
    });
  }
  add("fm",o.months);add("fmg",o.managers);add("fp",o.processes);add("fc",o.counsellors);
}
function onMonth(){
  var m=gv("fm"),ws=document.getElementById("fw");
  ws.innerHTML='<option value="">All Weeks</option>';ws.disabled=!m;
  if(m&&FOPTS.weeksByMonth&&FOPTS.weeksByMonth[m])
    FOPTS.weeksByMonth[m].forEach(function(w){var o=document.createElement("option");o.value=w;o.textContent=w;ws.appendChild(o);});
  render();
}
function onMgr(){
  var mg=gv("fmg"),cs=document.getElementById("fc");
  cs.innerHTML='<option value="">All Counsellors</option>';
  var l=mg?[...new Set(ALL.filter(function(d){return d.manager===mg;}).map(function(d){return d.counsellor;}))]:(FOPTS.counsellors||[]);
  l.sort().forEach(function(c){var o=document.createElement("option");o.value=c;o.textContent=c;cs.appendChild(o);});
  render();
}
function resetF(){
  ["fm","fw","fmg","fp","fc"].forEach(function(id){document.getElementById(id).value="";});
  document.getElementById("fw").disabled=true;
  render();
}

// â”€â”€ DATA HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fd(){
  var m=gv("fm"),w=gv("fw"),mg=gv("fmg"),p=gv("fp"),c=gv("fc");
  return ALL.filter(function(d){
    return(!m||d.month===m)&&(!w||d.week===w)&&(!mg||d.manager===mg)&&(!p||d.process===p)&&(!c||d.counsellor===c);
  });
}
function ag(data,key){
  var map={};
  data.forEach(function(d){
    var k=d[key];if(!k)return;
    if(!map[k])map[k]={name:k,r:0,a:0,mgr:d.manager,tl:d.teamLeader,procs:{},mgrs:{}};
    map[k].r+=d.leadsReceived;map[k].a+=d.leadsAchieved;
    map[k].procs[d.process]=1;map[k].mgrs[d.manager]=1;
  });
  return Object.values(map).map(function(x){
    return Object.assign({},x,{
      procs:Object.keys(x.procs),mgrs:Object.keys(x.mgrs),
      ratio:x.r>0?((x.a/x.r)*100).toFixed(1):"0.0"
    });
  }).sort(function(a,b){return b.r-a.r;});
}
function gv(id){return document.getElementById(id).value;}

// â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render(){
  var data=fd();
  var tR=data.reduce(function(s,d){return s+d.leadsReceived;},0);
  var tA=data.reduce(function(s,d){return s+d.leadsAchieved;},0);
  var cv=tR>0?((tA/tR)*100).toFixed(1):"0.0";
  var mgrs=ag(data,"manager");

  // Animate KPI counters
  animCount(document.getElementById("kv1"),tR);
  animCount(document.getElementById("kv2"),tA);
  var kv3=document.getElementById("kv3");
  kv3.textContent=cv+"%";
  var kv4=document.getElementById("kv4");
  animCount(kv4,mgrs.filter(function(m){return m.r>0;}).length);
  sv("ks1",data.length+" records");
  sv("ks4","of "+mgrs.length+" teams");

  if(CT==="overview")    rOv(data,mgrs,tR);
  if(CT==="managers")    rMg(data,mgrs);
  if(CT==="counsellors") rCn(data);
  if(CT==="process")     rPr(data);
  if(CT==="calendar")    rCal();
}

// â”€â”€ OVERVIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rOv(data,mgrs,tR){
  sv("mgr-badge",(mgrs.reduce(function(s,m){return s+m.r;},0)||"â€”")+" leads");
  var h="";
  mgrs.forEach(function(m){
    var c=MC[m.name]||"#888",pct=tR>0?(m.r/tR)*100:0;
    h+='<div class="mgr-row">';
    h+='<div class="mgr-head">';
    h+='<span class="mgr-name"><span class="color-dot" style="background:'+c+';color:'+c+'"></span>'+xe(m.name)+'</span>';
    h+='<span class="mgr-badges">';
    h+='<span class="pill pill-rcv">'+m.r+' rcv</span>';
    h+='<span class="pill pill-cv">'+m.ratio+'%</span>';
    h+='</span></div>';
    h+='<div class="bar-wrap"><div class="bar-fill" style="width:0%;background:linear-gradient(90deg,'+c+','+c+'77)" data-w="'+pct.toFixed(1)+'%"></div></div>';
    h+='<div class="bar-sub"><div class="bar-sub-fill" style="width:0%" data-w="'+Math.min(+m.ratio,100)+'%"></div></div>';
    h+='</div>';
  });
  sv("mgrbars",h||nd());
  requestAnimationFrame(function(){animBars();});

  // Trend
  var tm={};
  data.forEach(function(d){
    var k=d.month+"|"+d.week;
    var wm=d.week.match(/Week\s*\d+/i);
    var lbl=d.month.slice(0,3)+" "+(wm?wm[0]:d.week);
    if(!tm[k])tm[k]={l:lbl,r:0,a:0};
    tm[k].r+=d.leadsReceived;tm[k].a+=d.leadsAchieved;
  });
  var tr=Object.values(tm).filter(function(t){return t.r>0;});
  var mx=Math.max.apply(null,tr.map(function(t){return t.r;}).concat([1]));
  sv("trend-badge",tr.length+" weeks");
  var th="";
  tr.forEach(function(t,i){
    var c=PAL[i%PAL.length];
    th+='<div class="trend-row">';
    th+='<div class="trend-meta"><span class="trend-lbl">'+xe(t.l)+'</span><span class="trend-nums">'+t.r+' rcv Â· <em>'+t.a+'</em> ach</span></div>';
    th+='<div class="trend-track"><div class="trend-rcv" style="width:0%;background:linear-gradient(90deg,'+c+','+c+'44)" data-w="'+(t.r/mx*100).toFixed(1)+'%"></div>';
    th+='<div class="trend-ach" style="width:0%" data-w="'+(t.a/mx*100).toFixed(1)+'%"></div></div>';
    th+='</div>';
  });
  sv("trend",th||nd());
  requestAnimationFrame(function(){animBars();});

  // Top counsellors
  var top=ag(data,"counsellor").filter(function(c){return c.r>0;}).slice(0,5);
  var medals=["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰","â‘£","â‘¤"];
  var ch="";
  top.forEach(function(c,i){
    var col=MC[c.mgr]||"#888";
    ch+='<div class="top-card" style="background:'+col+'12;border:1px solid '+col+'2a">';
    ch+='<div class="top-rank"><span class="rank-medal">'+medals[i]+'</span>#'+(i+1)+'</div>';
    ch+='<div class="top-name">'+xe(c.name)+'</div>';
    ch+='<div class="top-mgr">'+xe(c.mgr)+'</div>';
    ch+='<div class="top-num" style="color:'+col+'">'+c.r+'</div>';
    ch+='<div class="top-cv">'+c.ratio+'% conv</div>';
    ch+='</div>';
  });
  var tc=document.getElementById("topcards");
  if(tc)tc.innerHTML=ch||nd();
}

// â”€â”€ ANIMATE BARS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function animBars(){
  document.querySelectorAll("[data-w]").forEach(function(el){
    var w=el.getAttribute("data-w");
    el.removeAttribute("data-w");
    requestAnimationFrame(function(){el.style.width=w;});
  });
}

// â”€â”€ MANAGERS TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rMg(data,mgrs){
  var h="";
  mgrs.forEach(function(m){
    var c=MC[m.name]||"#888";
    var rc=+m.ratio>=40?"var(--emerald)":"var(--rose)";
    var ps=m.procs.slice(0,3).map(function(p){
      return '<span class="tag" style="background:rgba(255,255,255,.04);color:var(--t2);border:1px solid var(--b1);font-size:10px">'+xe(p)+'</span>';
    }).join(" ");
    if(m.procs.length>3) ps+=' <span class="tag" style="background:rgba(255,255,255,.04);color:var(--t3)">+'+( m.procs.length-3)+'</span>';
    h+='<tr>';
    h+='<td><span style="display:inline-flex;align-items:center;gap:10px"><span style="width:9px;height:9px;border-radius:50%;background:'+c+';box-shadow:0 0 8px '+c+'88;display:inline-block;flex-shrink:0"></span><span class="td-name">'+xe(m.name)+'</span></span></td>';
    h+='<td class="td-num" style="color:'+c+'">'+m.r+'</td>';
    h+='<td class="td-num" style="color:var(--emerald)">'+m.a+'</td>';
    h+='<td><span class="tag" style="background:'+rc.replace('var(','').replace(')','')+'18;color:'+rc+';border:1px solid '+rc.replace('var(','').replace(')','')+'40;font-size:12.5px;font-weight:700">'+m.ratio+'%</span></td>';
    h+='<td><div class="cv-bar-wrap"><div class="cv-track"><div class="cv-fill" style="width:'+Math.min(+m.ratio,100)+'%;background:linear-gradient(90deg,'+c+',var(--emerald))"></div></div><span style="font-size:11px;color:var(--t3)">'+m.ratio+'%</span></div></td>';
    h+='<td>'+ps+'</td>';
    h+='</tr>';
  });
  sv("mgrtbody",h);
}

// â”€â”€ COUNSELLORS TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rCn(data){
  var stats=ag(data,"counsellor"),h="";
  stats.forEach(function(c,i){
    var col=MC[c.mgr]||"#888";
    var rc=+c.ratio>=40?"var(--emerald)":"var(--rose)";
    h+='<tr>';
    h+='<td class="td-rank">'+(i+1)+'</td>';
    h+='<td class="td-name">'+xe(c.name)+'</td>';
    h+='<td><span class="tag" style="background:'+col+'14;color:'+col+';border:1px solid '+col+'30">'+xe(c.mgr)+'</span></td>';
    h+='<td style="color:var(--t3);font-size:12px">'+xe(c.tl||"â€”")+'</td>';
    h+='<td class="td-num" style="color:'+col+'">'+c.r+'</td>';
    h+='<td class="td-num" style="color:var(--emerald)">'+c.a+'</td>';
    h+='<td><div class="cv-bar-wrap"><div class="cv-track"><div class="cv-fill" style="width:'+Math.min(+c.ratio,100)+'%;background:'+rc+'"></div></div><span style="font-family:Fira Code,monospace;font-size:11px;color:'+rc+';font-weight:600;min-width:38px">'+c.ratio+'%</span></div></td>';
    h+='</tr>';
  });
  sv("cnsltbody",h);
}

// â”€â”€ PROCESS CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rPr(data){
  var stats=ag(data,"process");
  var mx=Math.max.apply(null,stats.map(function(s){return s.r;}).concat([1]));
  var h="";
  stats.forEach(function(p,i){
    var c=PAL[i%PAL.length];
    var rc=+p.ratio>=40?"var(--emerald)":"var(--rose)";
    var rcHex=+p.ratio>=40?"#00f5a0":"#ff4f7b";
    h+='<div class="proc-card" style="border-color:'+c+'22">';
    h+='<div style="position:absolute;top:0;left:0;right:0;height:3px;border-radius:var(--r2) var(--r2) 0 0;background:linear-gradient(90deg,'+c+','+c+'44)"></div>';
    h+='<span class="proc-badge" style="background:'+rcHex+'14;color:'+rc+';border:1px solid '+rcHex+'30">'+p.ratio+'%</span>';
    h+='<div class="proc-name">'+xe(p.name)+'</div>';
    h+='<div class="proc-grid">';
    h+='<div class="proc-metric"><div class="proc-mlbl">Received</div><div class="proc-mval" style="color:'+c+'">'+p.r+'</div></div>';
    h+='<div class="proc-metric"><div class="proc-mlbl">Achieved</div><div class="proc-mval" style="color:var(--emerald)">'+p.a+'</div></div>';
    h+='<div class="proc-metric"><div class="proc-mlbl">Counsellors</div><div class="proc-mval" style="color:var(--t1)">'+p.procs.length+'</div></div>';
    h+='<div class="proc-metric"><div class="proc-mlbl">Managers</div><div class="proc-mval" style="color:var(--t1)">'+p.mgrs.length+'</div></div>';
    h+='</div>';
    h+='<div class="proc-track"><div class="proc-fill" style="width:'+(p.r/mx*100)+'%;background:linear-gradient(90deg,'+c+','+c+'55)"></div></div>';
    h+='</div>';
  });
  sv("procgrid",h||nd());
}

// â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rCal(){
  var mn=MN[CM]; sv("calmn",mn); sv("calyr",CY);
  var meta=MM[mn],act=new Set();
  if(meta)meta.r.forEach(function(r){for(var d=r[0];d<=r[1];d++)act.add(d);});
  var dim=(CM===1&&CY%4===0&&(CY%100!==0||CY%400===0))?29:MD[CM];
  var fday=new Date(CY,CM,1).getDay();
  var h=DN.map(function(d){return'<div class="cal-dow">'+d+'</div>';}).join("");
  for(var i=0;i<fday;i++)h+="<div></div>";
  for(var day=1;day<=dim;day++){
    var key=CY+"-"+CM+"-"+day;
    var isSel=SEL.has(key),isAct=act.has(day);
    var cls="cal-day"+(isSel?" sel":isAct?" has":"");
    var ttl=wkD(mn,day)||"";
    h+='<div class="'+cls+'" onclick="tD('+day+')" title="'+ttl+'">'+day+(isAct&&!isSel?'<span class="cal-pip"></span>':"")+' </div>';
  }
  sv("cgrid",h);

  var wh="";
  if(meta)meta.r.forEach(function(r,i){
    wh+='<div class="wk-item"><div class="wk-name">Week '+(i+1)+'</div><div class="wk-dates">'+r[0]+' â€“ '+r[1]+' '+mn+'</div></div>';
  });
  else wh='<div class="no-data" style="padding:20px 0">No week data</div>';
  sv("wkranges",wh);

  var sel=[...SEL].sort();
  sv("selcnt",sel.length);
  document.getElementById("btnclr").style.display=sel.length?"":"none";
  var sh=sel.map(function(k){
    var p=k.split("-");
    return'<div class="sel-item"><span>'+(MN[+p[1]]||p[1])+' '+p[2]+', '+p[0]+'</span><button class="sel-remove" onclick="rD(\''+k+'\')">Ã—</button></div>';
  }).join("");
  sv("sellist",sh||'<div style="color:var(--t4);font-family:Fira Code,monospace;font-size:10px;text-align:center;padding:20px 0;letter-spacing:2px">CLICK DAYS TO SELECT</div>');
}

function wkD(mn,d){var m=MM[mn];if(!m)return null;var i=m.r.findIndex(function(r){return d>=r[0]&&d<=r[1];});return i>=0?"Week "+(i+1):null;}
function tD(d){var k=CY+"-"+CM+"-"+d;SEL.has(k)?SEL.delete(k):SEL.add(k);rCal();}
function rD(k){SEL.delete(k);rCal();}
function clearSel(){SEL.clear();rCal();}
function calNav(dir){CM+=dir;if(CM<0){CM=11;CY--;}else if(CM>11){CM=0;CY++;}rCal();}

// â”€â”€ TAB NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function go(t){
  document.querySelectorAll("[id^='tab-']").forEach(function(el){el.classList.add("hidden");});
  var tab=document.getElementById("tab-"+t);
  if(tab)tab.classList.remove("hidden");
  document.querySelectorAll(".tab").forEach(function(b){
    b.classList.toggle("on",b.getAttribute("onclick").indexOf("'"+t+"'")>=0);
  });
  CT=t; render();
}

// â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function sv(id,v){var el=document.getElementById(id);if(el)el.innerHTML=v;}
function nd(){return'<div class="no-data">No data for current filters</div>';}
function xe(s){var d=document.createElement("div");d.textContent=s||"";return d.innerHTML;}
</script>
</body>
</html>
